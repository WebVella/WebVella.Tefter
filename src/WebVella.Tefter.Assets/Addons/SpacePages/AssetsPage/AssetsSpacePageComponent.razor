@namespace WebVella.Tefter.Assets.Addons
@using WebVella.Tefter.UI.Components
@inherits TucBaseSpacePageComponent

@if (_isLoaded)
{
	@if (Context.Mode == TfComponentMode.Read)
	{
		<AssetsFolderComponent Folder="_folder" Context="@Context"
		                       DataIdentityValue="@_dataIdentityValue"/>
		                       @* Style="height: calc(100vh - var(--tf-header-height) - var(--tf-content-margin-bottom) - var(--tf-content-border-top-width)) !important"/> *@
	}
	else if (Context.Mode == TfComponentMode.Create || Context.Mode == TfComponentMode.Update)
	{
		<FluentGrid>
			<FluentGridItem xs="6">
				<TucSelect SelectedOption="@_optionsFolder"
				           SelectedOptionChanged="_optionsFolderChangeHandler"
				           TOption="AssetsFolder"
				           Items="@_folders" Style="width:100%"
				           OptionValue="@((p) => p.Id.ToString())"
				           Placeholder="@LOC("select..")"
				           OptionText="@(p => p.Name)" Label="@LOC("Select folder")"
				           Class="@GetValidationCssClass(nameof(_options.FolderId))"/>
				<TucValidationMessage Field="@(nameof(_options.FolderId))" Errors="ValidationErrors"/>
			</FluentGridItem>
			<FluentGridItem xs="6">
				<TucSelect SelectedOption="@_options.ViewType"
				           SelectedOptionChanged="((x) => _options.ViewType = x)"
				           TOption="AssetsFolderViewType"
				           Items="@(Enum.GetValues<AssetsFolderViewType>())" Style="width:100%"
				           OptionValue="@((p) => ((int)p).ToString())"
				           OptionText="@(p => p.ToDescriptionString())" Label="@LOC("Folder presentation")"
				           Class="@GetValidationCssClass(nameof(_options.ViewType))"/>
				<TucValidationMessage Field="@(nameof(_options.ViewType))" Errors="ValidationErrors"/>
			</FluentGridItem>
		</FluentGrid>

		<FluentGrid>
			<FluentGridItem xs="6">
				<TucSelect SelectedOption="@_options.DataIdentityValueType"
				           SelectedOptionChanged="((x) => _options.DataIdentityValueType = x)"
				           TOption="AssetsFolderDataIdentityValueType"
				           Items="@(Enum.GetValues<AssetsFolderDataIdentityValueType>())" Style="width:100%"
				           OptionValue="@((p) => ((int)p).ToString())"
				           OptionText="@(p => p.ToDescriptionString())" Label="@LOC("Data Identity value")"
				           Class="@GetValidationCssClass(nameof(_options.DataIdentityValueType))"/>
				<TucValidationMessage Field="@(nameof(_options.DataIdentityValueType))" Errors="ValidationErrors"/>
			</FluentGridItem>
			<FluentGridItem xs="6">
				@if (_options.DataIdentityValueType == AssetsFolderDataIdentityValueType.CustomString)
				{
					<FluentTextField TextFieldType="@TextFieldType.Text"
					                 Placeholder="@LOC("empty string")"
					                 @bind-Value=@_options.CustomDataIdentityValue AutoComplete="off"
					                 Label="@LOC("Custom data identity type")" Style="width:100%"/>
					<TucValidationMessage Field="@(nameof(_options.FolderId))" Errors="ValidationErrors"/>
				}
			</FluentGridItem>
		</FluentGrid>
	}
	else if (Context.Mode == TfComponentMode.Manage)
	{
		<TucCard Title="@LOC("Settings")">
			<ToolbarTemplate>
				<FluentButton Appearance="@Appearance.Outline" OnClick="_editFolder">
					@LOC("Edit")
					<FluentIcon Value="@TfConstants.GetIcon("Edit")" Color="@Color.Accent" Slot="start"/>
				</FluentButton>
			</ToolbarTemplate>
			<ChildContent>
	<FluentGrid>
			<FluentGridItem xs="6">
				<TucSelect SelectedOption="@_optionsFolder"
				           SelectedOptionChanged="_optionsFolderChangeHandler"
				           TOption="AssetsFolder"
				           Items="@_folders" Style="width:100%"
				           OptionValue="@((p) => p.Id.ToString())"
				           Placeholder="@LOC("select..")"
				           OptionText="@(p => p.Name)" Label="@LOC("Select folder")"
				           Class="@GetValidationCssClass(nameof(_options.FolderId))"
				           ReadOnly="true"/>
			</FluentGridItem>
			<FluentGridItem xs="6">
				<TucSelect SelectedOption="@_options.ViewType"
				           SelectedOptionChanged="((x) => _options.ViewType = x)"
				           TOption="AssetsFolderViewType"
				           Items="@(Enum.GetValues<AssetsFolderViewType>())" Style="width:100%"
				           OptionValue="@((p) => ((int)p).ToString())"
				           OptionText="@(p => p.ToDescriptionString())" Label="@LOC("Folder presentation")"
				           Class="@GetValidationCssClass(nameof(_options.ViewType))" ReadOnly="true"/>
			</FluentGridItem>
		</FluentGrid>

		<FluentGrid>
			<FluentGridItem xs="6">
				<TucSelect SelectedOption="@_options.DataIdentityValueType"
				           SelectedOptionChanged="((x) => _options.DataIdentityValueType = x)"
				           TOption="AssetsFolderDataIdentityValueType"
				           Items="@(Enum.GetValues<AssetsFolderDataIdentityValueType>())" Style="width:100%"
				           OptionValue="@((p) => ((int)p).ToString())"
				           OptionText="@(p => p.ToDescriptionString())" Label="@LOC("Data Identity value")"
				           Class="@GetValidationCssClass(nameof(_options.DataIdentityValueType))"
				           ReadOnly="true"/>
			</FluentGridItem>
			<FluentGridItem xs="6">
				@if (_options.DataIdentityValueType == AssetsFolderDataIdentityValueType.CustomString)
				{
					<FluentTextField TextFieldType="@TextFieldType.Text"
					                 Placeholder="@LOC("empty string")"
					                 @bind-Value=@_options.CustomDataIdentityValue AutoComplete="off"
					                 Label="@LOC("Custom data identity type")" Style="width:100%" ReadOnly="true"/>
				}
			</FluentGridItem>
		</FluentGrid>				
			</ChildContent>
		</TucCard>
	}
	else
	{
		<FluentMessageBar AllowDismiss="false" Intent="@MessageIntent.Error">@LOC("Mode: {0} not supported",Context.Mode.ToString())</FluentMessageBar>
	}	
}

