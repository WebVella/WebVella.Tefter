@inherits TfBaseComponent

@if (DataProviderDetailsState.Value.Provider is null || DataProviderDetailsState.Value.Provider.Columns is null
		|| DataProviderDetailsState.Value.Provider.Columns.Count == 0)
{
	<FluentMessageBar Title="@LOC("No columns")" AllowDismiss="false"
					  Intent="@MessageIntent.Info">@LOC("No columns are created yet for this data source")</FluentMessageBar>
}
else
{
	<FluentMessageBar Intent="@MessageIntent.Warning" AllowDismiss="false"
					  Title="@LOC("Missing Synchronization Key")" Style="margin-bottom:1rem;">
		@LOC("This data source is missing its syncronization key. No data syncronization is possible until this key is created. Once you have added the schema columns, you can do that in the next 'Shared Keys' tab.")
	</FluentMessageBar>
	<div class="tf-grid-wrapper">
		<table class="tf-grid">
			<thead class="tf-grid-thead">
				<tr class="tf-grid-tr">
					<th class="tf-grid-th" style="width:50px;"></th>
					<th class="tf-grid-th">name</th>
					<th class="tf-grid-th">type</th>
					<th class="tf-grid-th" style="width:120px;">created on</th>
					<th class="tf-grid-th">details</th>
				</tr>
			</thead>
			<tbody class="tf-grid-tbody">
				@foreach (var context in DataProviderDetailsState.Value.Provider.Columns)
				{
					<tr @key=context.Id class="tf-grid-tr">
						<td class="tf-grid-td">
							<div>
								<FluentButton Appearance="@Appearance.Outline" IconStart="@(new Icons.Regular.Size20.Edit())" 
									Title="@LOC("Edit column")" OnClick="@(()=> _editColumn(context))"/>
								<FluentButton Appearance="@Appearance.Outline" OnClick="@(()=> _deleteColumn(context))" Title="@LOC("Delete column")">
									<FluentIcon Color="@Color.Error" Value="@(new Icons.Regular.Size20.Delete())" />
								</FluentButton>
							</div>
						</td>
						<td class="tf-grid-td">
							<div>
								<div>@context.DbName</div>
								<div class="td-description">@context.SourceName</div>
							</div>
						</td>
						<td class="tf-grid-td">
							<div>
								<div>@context.DbType</div>
								<div class="td-description">@context.SourceType</div>
							</div>
						</td>
						<td class="tf-grid-td">
							<div title="@context.CreatedOn.ToShortDateString() @context.CreatedOn.ToShortTimeString()">@context.CreatedOn.ToShortDateString()</div>
						</td>
						<td class="tf-grid-td">
							<div>
								<FluentStack>
									@if (context.IsNullable)
									{
										<FluentBadge Appearance="@Appearance.Accent">nullable</FluentBadge>
									}
									@if (context.IsUnique)
									{
										<FluentBadge Appearance="@Appearance.Accent">unique</FluentBadge>
									}
									@if (context.IsSearchable)
									{
										<FluentBadge Appearance="@Appearance.Accent">searchable [@context.PreferredSearchType]</FluentBadge>
									}
									@if (context.IncludeInTableSearch)
									{
										<FluentBadge Appearance="@Appearance.Accent">global search</FluentBadge>
									}
									@if (context.IsSortable)
									{
										<FluentBadge Appearance="@Appearance.Accent">sortable</FluentBadge>
									}
									@if (context.AutoDefaultValue)
									{
										<FluentBadge Appearance="@Appearance.Accent">autogenerated</FluentBadge>
									}
								</FluentStack>
							</div>
						</td>
					</tr>
				}
			</tbody>
		</table>
	</div>

}

