@namespace WebVella.Tefter.UI.Components
@inherits TfBaseComponent
<div class="tf-aside-actions">
    @if (TfAuthLayout.GetState().Space is not null && TfAuthLayout.GetState().User.IsAdmin)
    {
        var state = TfAuthLayout.GetState();
        <FluentButton Id="new-space-page-menu-toggle" 
                      Appearance="@Appearance.Outline" Title="@LOC("Create new Space of page")"  
                      OnClick="@(() => _addMenuVisible = !_addMenuVisible)">@LOC("create new")</FluentButton>        
        <FluentMenu @bind-Open="_addMenuVisible" Anchor="new-space-page-menu-toggle" UseMenuService="true"
                    HorizontalPosition="HorizontalPosition.Right">
            <FluentMenuItem
                OnClick="@_addPage">
                @LOC("New Page")
                <span slot="start">
                    <FluentIcon Value="@TfConstants.GetIcon("DocumentAdd")" Slot="start"/>
                </span>
            </FluentMenuItem>         
            <FluentMenuItem
                OnClick="@_addSpace">
                @LOC("New Space")
                <span slot="start">
                    <FluentIcon Value="@TfConstants.GetIcon("AddCircle")" Slot="start"/>
                </span>
            </FluentMenuItem>               
        </FluentMenu>
        
        <FluentButton Id="space-menu-toggle"
                      Appearance="@Appearance.Outline" Title="@LOC("Space settings")"
                      OnClick="@(() => _spaceMenuVisible = !_spaceMenuVisible)">@LOC("settings")</FluentButton>  

        <FluentMenu @bind-Open="_spaceMenuVisible" Anchor="space-menu-toggle" UseMenuService="true"
                    HorizontalPosition="HorizontalPosition.Right">
            @if (TfAuthLayout.GetState().SpacePage is not null)
            {
                <FluentMenuItem
                    Disabled="true">
                    @LOC("Current Page")
                    @if (!String.IsNullOrWhiteSpace(state.SpacePage?.FluentIconName))
                    {
                        <span slot="start">
                            <FluentIcon Value="@(TfConstants.GetIcon(state.SpacePage?.FluentIconName)!.WithColor("var(--neutral-foreground-hint)"))" Slot="start"/>
                        </span>
                    }
                </FluentMenuItem>
                <FluentDivider/>
                <FluentMenuItem
                    OnClick="@_copyPage">
                    @LOC("Copy Page")
                    <span slot="start">
                        <FluentIcon Value="@TfConstants.GetIcon("Copy")" Slot="start"/>
                    </span>
                </FluentMenuItem>
                <FluentMenuItem
                    OnClick="@_manageCurrentPage">
                    @LOC("Page Properties")
                    <span slot="start">
                        <FluentIcon Value="@TfConstants.GetIcon("Settings")" Slot="start"/>
                    </span>
                </FluentMenuItem>
                <FluentMenuItem
                    OnClick="@_removePage">
                    @LOC("Delete Page")
                    <span slot="start">
                        <FluentIcon Value="@(TfConstants.GetIcon("Delete")!.WithColor(Color.Error))" Slot="start"/>
                    </span>
                </FluentMenuItem>
                <FluentDivider/>
            }
            <FluentMenuItem
                Disabled="true">
                @LOC("Current Space")
                @if (!String.IsNullOrWhiteSpace(state.Space?.FluentIconName))
                {
                <span slot="start">
                    <FluentIcon Value="@(TfConstants.GetIcon(state.Space?.FluentIconName)!.WithColor("var(--neutral-foreground-hint)"))" Slot="start" />
                </span>
                }
            </FluentMenuItem>
            <FluentDivider/>            
            <FluentMenuItem
                OnClick="@_manageCurrentSpace">
                @LOC("Space Properties")
                <span slot="start">
                    <FluentIcon Value="@TfConstants.GetIcon("Settings")" Slot="start"/>
                </span>
            </FluentMenuItem>
            <FluentMenuItem
                OnClick="@_deleteSpace">
                @LOC("Delete Space")
                <span slot="start">
                    <FluentIcon Value="@(TfConstants.GetIcon("Delete")!.WithColor(Color.Error))" Slot="start"/>
                </span>
            </FluentMenuItem>            
        </FluentMenu>
    }
</div>