@namespace WebVella.Tefter.UI.Components
@inherits TfBaseComponent
<FluentMenu @bind-Open="_open" Anchor="view-share-selector" UseMenuService="true"
            HorizontalPosition="HorizontalPosition.Right">
	<FluentMenuItem OnClick="_copyLinkToClipboard">
		@LOC("Copy link")
		<FluentIcon Value="@TfConstants.GetIcon("Link")" Slot="start"/>
	</FluentMenuItem>
	<FluentDivider/>
	@if (SelectedRows.Count > 0)
	{
		<FluentMenuItem>
			<ChildContent>
				@LOC("Export Selected")
				<FluentIcon Value="@TfConstants.GetIcon("CloudArrowDown").WithColor(Color.Neutral)" Slot="start"/>
				<span slot="end">(@SelectedRows.Count)</span>
			</ChildContent>
			<MenuItems>
				<FluentMenuItem OnClick="_exportCSVSelection">
					@LOC("CSV File")
					<FluentIcon Value="@TfConstants.GetIcon("DocumentBulletList")" Slot="start"/>
				</FluentMenuItem>
				<FluentMenuItem Disabled="@(SelectedRows.Count == 0)" OnClick="_exportExcelSelection">
					@LOC("Excel File")
					<FluentIcon Value="@TfConstants.GetIcon("DocumentTable")" Slot="start"/>
				</FluentMenuItem>

			</MenuItems>
		</FluentMenuItem>
	}
	else
	{
		<FluentMenuItem Disabled="true">
			<ChildContent>
				@LOC("Export Selected")
				<FluentIcon Value="@TfConstants.GetIcon("CloudArrowDown").WithColor(Color.Neutral)" Slot="start"/>
				<span slot="end">(0)</span>
			</ChildContent>
		</FluentMenuItem>
	}
	<FluentMenuItem>
		<ChildContent>
			@LOC("Export All")
			<FluentIcon Value="@TfConstants.GetIcon("CloudArrowDown").WithColor(Color.Neutral)" Slot="start"/>
		</ChildContent>
		<MenuItems>
			<FluentMenuItem OnClick="_exportCSVAll">
				@LOC("CSV File")
				<FluentIcon Value="@TfConstants.GetIcon("DocumentBulletList")" Slot="start"/>
			</FluentMenuItem>
			<FluentMenuItem OnClick="_exportExcelAll">
				@LOC("Excel File")
				<FluentIcon Value="@TfConstants.GetIcon("DocumentTable")" Slot="start"/>
			</FluentMenuItem>
		</MenuItems>
	</FluentMenuItem>
</FluentMenu>
<div style="display:none">
	<form method="post" name="ExportCSVSelection" action="@_exportCSVUrl" class="ant-form ant-form-vertical">
		<input type="hidden" name="data" value="@_getExportSelectionData()"/>
		<button type="submit" id="@_exportCSVSelectionBtnId"></button>
	</form>
	<form method="post" name="ExportCSVAll" action="@_exportCSVUrl" class="ant-form ant-form-vertical">
		<input type="hidden" name="data" value="@_getExportAllData()"/>
		<button type="submit" id="@_exportCSVAllBtnId"></button>
	</form>
	<form method="post" name="ExportExcelSelection" action="@_exportExcelUrl" class="ant-form ant-form-vertical">
		<input type="hidden" name="data" value="@_getExportSelectionData()"/>
		<button type="submit" id="@_exportExcelSelectionBtnId"></button>
	</form>
	<form method="post" name="ExportExcelAll" action="@_exportExcelUrl" class="ant-form ant-form-vertical">
		<input type="hidden" name="data" value="@_getExportAllData()"/>
		<button type="submit" id="@_exportExcelAllBtnId"></button>
	</form>
</div>


